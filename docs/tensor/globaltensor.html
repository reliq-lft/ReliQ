<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--  This file is generated by Nim. -->
<html xmlns="https://www.w3.org/1999/xhtml" xml:lang="en" lang="en" data-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tensor/globaltensor</title>

<!-- Google fonts -->
<link href='https://fonts.googleapis.com/css?family=Lato:400,600,900' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/css?family=Source+Code+Pro:400,500,600' rel='stylesheet' type='text/css'/>

<!-- Favicon -->
<link rel="shortcut icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAUAAAAF////AP///wD///8A////AP///wD///8A////AP///wD///8A////AAAAAAIAAABbAAAAlQAAAKIAAACbAAAAmwAAAKIAAACVAAAAWwAAAAL///8A////AP///wD///8A////AAAAABQAAADAAAAAYwAAAA3///8A////AP///wD///8AAAAADQAAAGMAAADAAAAAFP///wD///8A////AP///wAAAACdAAAAOv///wD///8A////AP///wD///8A////AP///wD///8AAAAAOgAAAJ3///8A////AP///wAAAAAnAAAAcP///wAAAAAoAAAASv///wD///8A////AP///wAAAABKAAAAKP///wAAAABwAAAAJ////wD///8AAAAAgQAAABwAAACIAAAAkAAAAJMAAACtAAAAFQAAABUAAACtAAAAkwAAAJAAAACIAAAAHAAAAIH///8A////AAAAAKQAAACrAAAAaP///wD///8AAAAARQAAANIAAADSAAAARf///wD///8AAAAAaAAAAKsAAACk////AAAAADMAAACcAAAAnQAAABj///8A////AP///wAAAAAYAAAAGP///wD///8A////AAAAABgAAACdAAAAnAAAADMAAAB1AAAAwwAAAP8AAADpAAAAsQAAAE4AAAAb////AP///wAAAAAbAAAATgAAALEAAADpAAAA/wAAAMMAAAB1AAAAtwAAAOkAAAD/AAAA/wAAAP8AAADvAAAA3gAAAN4AAADeAAAA3gAAAO8AAAD/AAAA/wAAAP8AAADpAAAAtwAAAGUAAAA/AAAA3wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAADfAAAAPwAAAGX///8A////AAAAAEgAAADtAAAAvwAAAL0AAADGAAAA7wAAAO8AAADGAAAAvQAAAL8AAADtAAAASP///wD///8A////AP///wD///8AAAAAO////wD///8A////AAAAAIcAAACH////AP///wD///8AAAAAO////wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A//8AAP//AAD4HwAA7/cAAN/7AAD//wAAoYUAAJ55AACf+QAAh+EAAAAAAADAAwAA4AcAAP5/AAD//wAA//8AAA=="/>
<link rel="icon" type="image/png" sizes="32x32" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA3XAAAN1wFCKJt4AAAAB3RJTUUH4QQQEwksSS9ZWwAAAk1JREFUWMPtll2ITVEUx39nn/O7Y5qR8f05wtCUUr6ZIS++8pEnkZInPImneaCQ5METNdOkeFBKUhMPRIkHKfEuUZSUlGlKPN2TrgfncpvmnntnmlEyq1Z7t89/rf9a6+y99oZxGZf/XeIq61EdtgKXgdXA0xrYAvBjOIF1AI9zvjcC74BSpndrJPkBWDScTF8Aa4E3wDlgHbASaANmVqlcCnwHvgDvgVfAJ+AikAAvgfVZwLnSVZHZaOuKoQi3ZOMi4NkYkpe1p4J7A8BpYAD49hfIy/oqG0+hLomiKP2L5L+1ubn5115S+3OAn4EnwBlgMzCjyt6ZAnQCJ4A7wOs88iRJHvw50HoujuPBoCKwHWiosy8MdfZnAdcHk8dxXFJ3VQbQlCTJvRBCGdRbD4M6uc5glpY3eAihpN5S5w12diSEcCCEcKUO4ljdr15T76ur1FDDLIQQ3qv71EdDOe3Kxj3leRXyk+pxdWnFWod6Wt2bY3de3aSuUHcPBVimHs7mK9WrmeOF6lR1o9qnzskh2ar2qm1qizpfXaPeVGdlmGN5pb09qMxz1Xb1kLqgzn1RyH7JUXW52lr5e/Kqi9qpto7V1atuUzfnARrV7jEib1T76gG2qxdGmXyiekkt1GswPTtek0aBfJp6YySGBfWg2tPQ0FAYgf1stUfdmdcjarbYJEniKIq6gY/Aw+zWHAC+p2labGpqiorFYgGYCEzN7oQdQClN07O1/EfDyGgC0ALMBdYAi4FyK+4H3gLPsxfR1zRNi+NP7nH5J+QntnXe5B5mpfQAAAAASUVORK5CYII=">

<!-- CSS -->
<link rel="stylesheet" type="text/css" href="../nimdoc.out.css?v=2.2.4">

<!-- JS -->
<script type="text/javascript" src="../dochack.js?v=2.2.4"></script>
</head>
<body>
  <div class="document" id="documentId">
    <div class="container">
      <h1 class="title">tensor/globaltensor</h1>
      <div class="row">
  <div class="three columns">
    <div class="theme-select-wrapper">
      <label for="theme-select">Theme:&nbsp;</label>
      <select id="theme-select" onchange="setTheme(this.value)">
        <option value="auto">ðŸŒ— Match OS</option>
        <option value="dark">ðŸŒ‘ Dark</option>
        <option value="light">ðŸŒ• Light</option>
      </select>
    </div>
    <div id="global-links">
      <ul class="simple">
        <li><a id="indexLink" href="../theindex.html">Index</a></li>
      </ul>
    </div>
    <div id="searchInputDiv">
      Search: <input type="search" id="searchInput" oninput="search()"/>
    </div>
    <div>
      Group by:
      <select onchange="groupBy(this.value)">
        <option value="section">Section</option>
        <option value="type">Type</option>
      </select>
    </div>
    <ul class="simple simple-toc" id="toc-list">
  <li><a class="reference" id="globaltensor-minus-distributed-tensor-fields-via-global-arrays_toc" href="#globaltensor-minus-distributed-tensor-fields-via-global-arrays">GlobalTensor - Distributed Tensor Fields via Global Arrays</a></li>
<ul class="simple"><li><a class="reference" id="globaltensor-minus-distributed-tensor-fields-via-global-arrays-ga-memory-layout_toc" href="#globaltensor-minus-distributed-tensor-fields-via-global-arrays-ga-memory-layout">GA Memory Layout</a></li>
<li><a class="reference" id="globaltensor-minus-distributed-tensor-fields-via-global-arrays-example_toc" href="#globaltensor-minus-distributed-tensor-fields-via-global-arrays-example">Example</a></li>
</ul><li>
  <a class="reference reference-toplevel" href="#6" id="56">Imports</a>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#7" id="57">Types</a></summary>
    <ul class="simple simple-toc-section">
      <li><a class="reference" href="#GlobalShifter" title="GlobalShifter[D; R; L; T] = object
  dim*: int                  ## Shift dimension
  len*: int                  ## Displacement (+forward, -backward)
  ## MPI decomposition grid
  ## Product of localGeom[]
  ## Product of shape[]">GlobalShifter</a></li>
<li><a class="reference" href="#TensorField" title="TensorField[D; R; L; T] = object
  lattice*: L
  shape*: array[R, int]
  when D + R == 1:
    when isComplex32(T):
      data*: GlobalArray[2, float32]
    elif isComplex64(T):
      data*: GlobalArray[2, float64]
    else:
      data*: GlobalArray[2, T]
  elif D + R == 2:
    when isComplex32(T):
      data*: GlobalArray[3, float32]
    elif isComplex64(T):
      data*: GlobalArray[3, float64]
    else:
      data*: GlobalArray[3, T]
  elif D + R == 3:
    when isComplex32(T):
      data*: GlobalArray[4, float32]
    elif isComplex64(T):
      data*: GlobalArray[4, float64]
    else:
      data*: GlobalArray[4, T]
  elif D + R == 4:
    when isComplex32(T):
      data*: GlobalArray[5, float32]
    elif isComplex64(T):
      data*: GlobalArray[5, float64]
    else:
      data*: GlobalArray[5, T]
  elif D + R == 5:
    when isComplex32(T):
      data*: GlobalArray[6, float32]
    elif isComplex64(T):
      data*: GlobalArray[6, float64]
    else:
      data*: GlobalArray[6, T]
  elif D + R == 6:
    when isComplex32(T):
      data*: GlobalArray[7, float32]
    elif isComplex64(T):
      data*: GlobalArray[7, float64]
    else:
      data*: GlobalArray[7, T]
  elif D + R == 7:
    when isComplex32(T):
      data*: GlobalArray[8, float32]
    elif isComplex64(T):
      data*: GlobalArray[8, float64]
    else:
      data*: GlobalArray[8, T]
  elif D + R == 8:
    when isComplex32(T):
      data*: GlobalArray[9, float32]
    elif isComplex64(T):
      data*: GlobalArray[9, float64]
    else:
      data*: GlobalArray[9, T]
  elif D + R == 9:
    when isComplex32(T):
      data*: GlobalArray[10, float32]
    elif isComplex64(T):
      data*: GlobalArray[10, float64]
    else:
      data*: GlobalArray[10, T]
  elif D + R == 10:
    when isComplex32(T):
      data*: GlobalArray[11, float32]
    elif isComplex64(T):
      data*: GlobalArray[11, float64]
    else:
      data*: GlobalArray[11, T]">TensorField</a></li>

    </ul>
  </details>
</li>
<li>
  <details open>
    <summary><a class="reference reference-toplevel" href="#12" id="62">Procs</a></summary>
    <ul class="simple simple-toc-section">
      <ul class="simple nested-toc-section">accessGhosts
  <li><a class="reference" href="#accessGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BaccessGhosts.D%5D%2CT%5D" title="accessGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): ptr UncheckedArray[T]">accessGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): ptr UncheckedArray[T]</a></li>

</ul>
<ul class="simple nested-toc-section">accessLocal
  <li><a class="reference" href="#accessLocal%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BaccessLocal.D%5D%2CT%5D" title="accessLocal[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): ptr UncheckedArray[T]">accessLocal[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): ptr UncheckedArray[T]</a></li>

</ul>
<ul class="simple nested-toc-section">apply
  <li><a class="reference" href="#apply%2CGlobalShifter%5BD%2CR%2CL%3A%20Lattice%5Bapply.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5Bapply.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5Bapply.D%5D%2CT%5D" title="apply[D: static[int]; R: static[int]; L: Lattice[D]; T](
    shifter: GlobalShifter[D, R, L, T]; src: TensorField[D, R, L, T];
    dest: var TensorField[D, R, L, T])">apply[D: static[int]; R: static[int]; L: Lattice[D]; T](
    shifter: GlobalShifter[D, R, L, T]; src: TensorField[D, R, L, T];
    dest: var TensorField[D, R, L, T])</a></li>

</ul>
<ul class="simple nested-toc-section">applyStencilShift
  <li><a class="reference" href="#applyStencilShift%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BapplyStencilShift.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BapplyStencilShift.D%5D%2CT%5D%2Cint%2Cint" title="applyStencilShift[D: static[int]; R: static[int]; L: Lattice[D]; T](
    src: TensorField[D, R, L, T]; dest: var TensorField[D, R, L, T]; dim: int;
    direction: int)">applyStencilShift[D: static[int]; R: static[int]; L: Lattice[D]; T](
    src: TensorField[D, R, L, T]; dest: var TensorField[D, R, L, T]; dim: int;
    direction: int)</a></li>

</ul>
<ul class="simple nested-toc-section">coordsToLex
  <li><a class="reference" href="#coordsToLex%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D" title="coordsToLex[D: static int](coords: array[D, int]; geom: array[D, int]): int">coordsToLex[D: static int](coords: array[D, int]; geom: array[D, int]): int</a></li>

</ul>
<ul class="simple nested-toc-section">coordsToPaddedFlat
  <li><a class="reference" href="#coordsToPaddedFlat%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D%2Cint" title="coordsToPaddedFlat[D: static int](coords: array[D, int];
                                  paddedGeom: array[D, int];
                                  ghostWidth: array[D, int]; innerBlockSize: int): int">coordsToPaddedFlat[D: static int](coords: array[D, int];
                                  paddedGeom: array[D, int];
                                  ghostWidth: array[D, int]; innerBlockSize: int): int</a></li>

</ul>
<ul class="simple nested-toc-section">discreteLaplacian
  <li><a class="reference" href="#discreteLaplacian%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BdiscreteLaplacian.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BdiscreteLaplacian.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BdiscreteLaplacian.D%5D%2CT%5D" title="discreteLaplacian[D: static[int]; R: static[int]; L: Lattice[D]; T](
    src: TensorField[D, R, L, T]; dest: var TensorField[D, R, L, T];
    scratch: var TensorField[D, R, L, T])">discreteLaplacian[D: static[int]; R: static[int]; L: Lattice[D]; T](
    src: TensorField[D, R, L, T]; dest: var TensorField[D, R, L, T];
    scratch: var TensorField[D, R, L, T])</a></li>

</ul>
<ul class="simple nested-toc-section">ghostWidth
  <li><a class="reference" href="#ghostWidth%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BghostWidth.D%5D%2CT%5D" title="ghostWidth[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): array[D, int]">ghostWidth[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): array[D, int]</a></li>

</ul>
<ul class="simple nested-toc-section">hasGhosts
  <li><a class="reference" href="#hasGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BhasGhosts.D%5D%2CT%5D" title="hasGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): bool">hasGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): bool</a></li>

</ul>
<ul class="simple nested-toc-section">innerBlockSize
  <li><a class="reference" href="#innerBlockSize%2Cstaticint%2CopenArray%5Bint%5D%2Cbool" title="innerBlockSize(R: static int; shape: openArray[int]; isComplex: bool): int">innerBlockSize(R: static int; shape: openArray[int]; isComplex: bool): int</a></li>

</ul>
<ul class="simple nested-toc-section">innerPaddedBlockSize
  <li><a class="reference" href="#innerPaddedBlockSize%2Cstaticint%2Cint" title="innerPaddedBlockSize(R: static int; ghostWidth: int): int">innerPaddedBlockSize(R: static int; ghostWidth: int): int</a></li>

</ul>
<ul class="simple nested-toc-section">innerPaddedOffset
  <li><a class="reference" href="#innerPaddedOffset%2Cstaticint%2Cint" title="innerPaddedOffset(R: static int; ghostWidth: int): int">innerPaddedOffset(R: static int; ghostWidth: int): int</a></li>

</ul>
<ul class="simple nested-toc-section">lexToCoords
  <li><a class="reference" href="#lexToCoords%2Cint%2Carray%5BD%2Cint%5D" title="lexToCoords[D: static int](idx: int; geom: array[D, int]): array[D, int]">lexToCoords[D: static int](idx: int; geom: array[D, int]): array[D, int]</a></li>

</ul>
<ul class="simple nested-toc-section">localGrid
  <li><a class="reference" href="#localGrid%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BlocalGrid.D%5D%2CT%5D" title="localGrid[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): array[D, int]">localGrid[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): array[D, int]</a></li>

</ul>
<ul class="simple nested-toc-section">localIdx
  <li><a class="reference" href="#localIdx%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BlocalIdx.D%5D%2CT%5D%2Carray%5BD%2Cint%5D" title="localIdx[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; coords: array[D, int]): int">localIdx[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; coords: array[D, int]): int</a></li>

</ul>
<ul class="simple nested-toc-section">localLexIdx
  <li><a class="reference" href="#localLexIdx%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BlocalLexIdx.D%5D%2CT%5D%2Cint" title="localLexIdx[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; site: int): int">localLexIdx[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; site: int): int</a></li>

</ul>
<ul class="simple nested-toc-section">localSiteOffset
  <li><a class="reference" href="#localSiteOffset%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D%2Cint" title="localSiteOffset[D: static int](coords: array[D, int]; paddedGeom: array[D, int];
                               innerBlockSize: int): int">localSiteOffset[D: static int](coords: array[D, int]; paddedGeom: array[D, int];
                               innerBlockSize: int): int</a></li>

</ul>
<ul class="simple nested-toc-section">newGlobalBackwardShifters
  <li><a class="reference" href="#newGlobalBackwardShifters%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewGlobalBackwardShifters.D%5D%2CT%5D%2Cint" title="newGlobalBackwardShifters[D: static[int]; R: static[int]; L: Lattice[D]; T](
    field: TensorField[D, R, L, T]; len: int = 1): array[D,
    GlobalShifter[D, R, L, T]]">newGlobalBackwardShifters[D: static[int]; R: static[int]; L: Lattice[D]; T](
    field: TensorField[D, R, L, T]; len: int = 1): array[D,
    GlobalShifter[D, R, L, T]]</a></li>

</ul>
<ul class="simple nested-toc-section">newGlobalShifter
  <li><a class="reference" href="#newGlobalShifter%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewGlobalShifter.D%5D%2CT%5D%2Cint%2Cint" title="newGlobalShifter[D: static[int]; R: static[int]; L: Lattice[D]; T](
    field: TensorField[D, R, L, T]; dim: int; len: int = 1): GlobalShifter[D, R,
    L, T]">newGlobalShifter[D: static[int]; R: static[int]; L: Lattice[D]; T](
    field: TensorField[D, R, L, T]; dim: int; len: int = 1): GlobalShifter[D, R,
    L, T]</a></li>

</ul>
<ul class="simple nested-toc-section">newGlobalShifters
  <li><a class="reference" href="#newGlobalShifters%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewGlobalShifters.D%5D%2CT%5D%2Cint" title="newGlobalShifters[D: static[int]; R: static[int]; L: Lattice[D]; T](
    field: TensorField[D, R, L, T]; len: int = 1): array[D,
    GlobalShifter[D, R, L, T]]">newGlobalShifters[D: static[int]; R: static[int]; L: Lattice[D]; T](
    field: TensorField[D, R, L, T]; len: int = 1): array[D,
    GlobalShifter[D, R, L, T]]</a></li>

</ul>
<ul class="simple nested-toc-section">newLatticeStencil
  <li><a class="reference" href="#newLatticeStencil%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewLatticeStencil.D%5D%2CT%5D%2CStencilPattern%5BD%5D" title="newLatticeStencil[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; pattern: StencilPattern[D]): LatticeStencil[
    D]">newLatticeStencil[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; pattern: StencilPattern[D]): LatticeStencil[
    D]</a></li>

</ul>
<ul class="simple nested-toc-section">newTensorField
  <li><a class="reference" href="#newTensorField%2CL%2Carray%5BR%2Cint%5D%2Ctypedesc" title="newTensorField[D: static[int]; R: static[int]; L: Lattice[D]](lattice: L;
    shape: array[R, int]; T: typedesc): TensorField[D, R, L, T]">newTensorField[D: static[int]; R: static[int]; L: Lattice[D]](lattice: L;
    shape: array[R, int]; T: typedesc): TensorField[D, R, L, T]</a></li>

</ul>
<ul class="simple nested-toc-section">paddedGrid
  <li><a class="reference" href="#paddedGrid%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BpaddedGrid.D%5D%2CT%5D" title="paddedGrid[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): array[D, int]">paddedGrid[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]): array[D, int]</a></li>

</ul>
<ul class="simple nested-toc-section">releaseLocal
  <li><a class="reference" href="#releaseLocal%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BreleaseLocal.D%5D%2CT%5D" title="releaseLocal[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T])">releaseLocal[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T])</a></li>

</ul>
<ul class="simple nested-toc-section">updateAllGhosts
  <li><a class="reference" href="#updateAllGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BupdateAllGhosts.D%5D%2CT%5D%2Cbool" title="updateAllGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; updateCorners: bool = false)">updateAllGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; updateCorners: bool = false)</a></li>

</ul>
<ul class="simple nested-toc-section">updateGhosts
  <li><a class="reference" href="#updateGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BupdateGhosts.D%5D%2CT%5D%2Cint%2Cint%2Cbool" title="updateGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; dim: int; direction: int = 0;
    updateCorners: bool = false)">updateGhosts[D: static[int]; R: static[int]; L: Lattice[D]; T](
    tensor: TensorField[D, R, L, T]; dim: int; direction: int = 0;
    updateCorners: bool = false)</a></li>

</ul>

    </ul>
  </details>
</li>

</ul>

  </div>
  <div class="nine columns" id="content">
    
    <div id="tocRoot"></div>
    
    <p class="module-desc">
<h1><a class="toc-backref" id="globaltensor-minus-distributed-tensor-fields-via-global-arrays" href="#globaltensor-minus-distributed-tensor-fields-via-global-arrays">GlobalTensor - Distributed Tensor Fields via Global Arrays</a></h1><p>This module provides <tt class="docutils literal"><span class="pre"><span class="Identifier">TensorField</span><span class="Punctuation">[</span><span class="Identifier">D</span><span class="Punctuation">,</span><span class="Identifier">R</span><span class="Punctuation">,</span><span class="Identifier">L</span><span class="Punctuation">,</span><span class="Identifier">T</span><span class="Punctuation">]</span></span></tt>, the primary distributed data type in ReliQ.  Each tensor field is backed by a <a class="reference external" href="https://globalarrays.github.io/">Global Array</a> with ghost (halo) regions, enabling transparent MPI communication of boundary data.</p>
<p>Key capabilities:</p>
<ul class="simple"><li><strong>Construction</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">newTensorField</span></span></tt> creates a GA-backed field with automatic MPI decomposition and ghost region allocation</li>
<li><strong>Local data access</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">accessLocal</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">accessGhosts</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">releaseLocal</span></span></tt> provide raw pointers into the local partition (with or without ghost cells)</li>
<li><strong>Ghost exchange</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">updateGhosts</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">updateAllGhosts</span></span></tt> synchronise boundary data between MPI ranks via <tt class="docutils literal"><span class="pre"><span class="Identifier">GA_Update_ghost_dir</span></span></tt></li>
<li><strong>Coordinate utilities</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">lexToCoords</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">coordsToLex</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">localIdx</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">localLexIdx</span></span></tt> handle the C row-major memory layout used by GA</li>
<li><strong>Shifting / transport</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">GlobalShifter</span></span></tt> performs distributed shifts (<tt class="docutils literal"><span class="pre">dest[x] = src[x + e_mu]</span></tt>) using ghost exchange, with correct handling of periodic boundary conditions for both distributed and non-distributed dimensions</li>
<li><strong>Stencil operations</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">applyStencilShift</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">discreteLaplacian</span></span></tt> implement common nearest-neighbour operations</li>
<li><strong>Stencil integration</strong>: <tt class="docutils literal"><span class="pre"><span class="Identifier">newLatticeStencil</span></span></tt> creates a unified <tt class="docutils literal"><span class="pre"><span class="Identifier">LatticeStencil</span><span class="Punctuation">[</span><span class="Identifier">D</span><span class="Punctuation">]</span></span></tt> from a tensor field's geometry</li>
</ul>

<h2><a class="toc-backref" id="globaltensor-minus-distributed-tensor-fields-via-global-arrays-ga-memory-layout" href="#globaltensor-minus-distributed-tensor-fields-via-global-arrays-ga-memory-layout">GA Memory Layout</a></h2><p>Global Arrays store data in <strong>C row-major</strong> order (last dimension fastest varying).  A <tt class="docutils literal"><span class="pre"><span class="Identifier">TensorField</span><span class="Punctuation">[</span><span class="Identifier">D</span><span class="Operator">=</span><span class="DecNumber">4</span><span class="Punctuation">,</span> <span class="Identifier">R</span><span class="Operator">=</span><span class="DecNumber">2</span><span class="Punctuation">,</span> <span class="Identifier">T</span><span class="Operator">=</span><span class="Identifier">float64</span><span class="Punctuation">]</span></span></tt> with <tt class="docutils literal"><span class="pre">shape = [3, 3]</span></tt> maps to a 7-dimensional GA <tt class="docutils literal"><span class="pre">[Lx, Ly, Lz, Lt, S0, S1, Cplx]</span></tt>.  The first <tt class="docutils literal"><span class="pre">D</span></tt> dimensions (lattice) carry ghost regions for boundary communication; the last <tt class="docutils literal"><span class="pre">R+1</span></tt> dimensions (tensor shape + complex component) also carry ghost width 1 because GA 5.8.2 requires <strong>all</strong> dimensions to have <tt class="docutils literal"><span class="pre">ghost â‰¥ 1</span></tt> for <tt class="docutils literal"><span class="pre">GA_Update_ghost_dir</span></tt> to function.  The padded inner block therefore has <tt class="docutils literal"><span class="pre">(S_i + 2)</span></tt> entries per tensor dimension and <tt class="docutils literal"><span class="pre">(complexFactor + 2)</span></tt> for the complex dimension; only the central <tt class="docutils literal"><span class="pre">product(shape) * complexFactor</span></tt> elements are real data. Use <tt class="docutils literal"><span class="pre">innerPaddedBlockSize</span></tt> / <tt class="docutils literal"><span class="pre">innerPaddedOffset</span></tt> to navigate.</p>
<p>Two pointer types are available:</p>
<ul class="simple"><li><strong>Local pointer</strong> (<tt class="docutils literal"><span class="pre"><span class="Identifier">accessLocal</span></span></tt>): starts at the center of the padded inner block for the first local lattice site.  <tt class="docutils literal"><span class="pre">p[0]</span></tt> is element 0 at local coordinates <tt class="docutils literal"><span class="pre">(0,0,...,0)</span></tt>.  The stride between adjacent lattice sites is <tt class="docutils literal"><span class="pre">innerPaddedBlockSize</span></tt> (the product of all padded inner dimensions), <strong>not</strong> the number of real elements.  Use <tt class="docutils literal"><span class="pre"><span class="Identifier">localIdx</span></span></tt> to compute the correct flat index.</li>
<li><strong>Ghost pointer</strong> (<tt class="docutils literal"><span class="pre"><span class="Identifier">accessGhosts</span></span></tt>): starts at the origin of the full padded array.  Use <tt class="docutils literal"><span class="pre"><span class="Identifier">coordsToPaddedFlat</span></span></tt> to index into the ghost-padded lattice dimensions; at each site, add <tt class="docutils literal"><span class="pre">innerPaddedOffset</span></tt> to reach the first real element.</li>
</ul>

<h2><a class="toc-backref" id="globaltensor-minus-distributed-tensor-fields-via-global-arrays-example" href="#globaltensor-minus-distributed-tensor-fields-via-global-arrays-example">Example</a></h2><pre class="listing"><span class="Keyword">import</span> <span class="Identifier">reliq</span>

<span class="Identifier">parallel</span><span class="Punctuation">:</span>
  <span class="Keyword">let</span> <span class="Identifier">lat</span> <span class="Operator">=</span> <span class="Identifier">newSimpleCubicLattice</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">8</span><span class="Punctuation">,</span> <span class="DecNumber">8</span><span class="Punctuation">,</span> <span class="DecNumber">8</span><span class="Punctuation">,</span> <span class="DecNumber">16</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">4</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
  <span class="Keyword">var</span> <span class="Identifier">src</span>  <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span>
  <span class="Keyword">var</span> <span class="Identifier">dest</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span>
  
  <span class="Comment"># Fill src with global lex index</span>
  <span class="Keyword">let</span> <span class="Identifier">p</span> <span class="Operator">=</span> <span class="Identifier">src</span><span class="Operator">.</span><span class="Identifier">accessLocal</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
  <span class="Keyword">for</span> <span class="Identifier">site</span> <span class="Keyword">in</span> <span class="FloatNumber">0.</span><span class="Operator">.&lt;</span><span class="Identifier">nLocal</span><span class="Punctuation">:</span>
    <span class="Identifier">p</span><span class="Punctuation">[</span><span class="Identifier">src</span><span class="Operator">.</span><span class="Identifier">localLexIdx</span><span class="Punctuation">(</span><span class="Identifier">site</span><span class="Punctuation">)</span><span class="Punctuation">]</span> <span class="Operator">=</span> <span class="Identifier">float64</span><span class="Punctuation">(</span><span class="Identifier">site</span><span class="Punctuation">)</span>
  <span class="Identifier">src</span><span class="Operator">.</span><span class="Identifier">releaseLocal</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
  
  <span class="Comment"># Shift forward in t-direction</span>
  <span class="Keyword">let</span> <span class="Identifier">shifter</span> <span class="Operator">=</span> <span class="Identifier">newGlobalShifter</span><span class="Punctuation">(</span><span class="Identifier">src</span><span class="Punctuation">,</span> <span class="Identifier">dim</span> <span class="Operator">=</span> <span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="Identifier">len</span> <span class="Operator">=</span> <span class="DecNumber">1</span><span class="Punctuation">)</span>
  <span class="Identifier">shifter</span><span class="Operator">.</span><span class="Identifier">apply</span><span class="Punctuation">(</span><span class="Identifier">src</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Punctuation">)</span>   <span class="Comment"># dest[x] = src[x + e_t]</span>
  
  <span class="Comment"># Discrete Laplacian</span>
  <span class="Keyword">var</span> <span class="Identifier">lap</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span>
  <span class="Keyword">var</span> <span class="Identifier">tmp</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span>
  <span class="Identifier">discreteLaplacian</span><span class="Punctuation">(</span><span class="Identifier">src</span><span class="Punctuation">,</span> <span class="Identifier">lap</span><span class="Punctuation">,</span> <span class="Identifier">tmp</span><span class="Punctuation">)</span></pre></p>
    <div class="section" id="6">
  <h1><a class="toc-backref" href="#6">Imports</a></h1>
  <dl class="item">
    <a class="reference external" href="../lattice.html">../lattice</a>, <a class="reference external" href="../globalarrays/gatypes.html">../globalarrays/gatypes</a>, <a class="reference external" href="../globalarrays/gawrap.html">../globalarrays/gawrap</a>, <a class="reference external" href="../utils/complex.html">../utils/complex</a>, <a class="reference external" href="../lattice/stencil.html">../lattice/stencil</a>
  </dl>
</div>
<div class="section" id="7">
  <h1><a class="toc-backref" href="#7">Types</a></h1>
  <dl class="item">
    <div id="GlobalShifter">
  <dt><pre><a href="globaltensor.html#GlobalShifter"><span class="Identifier">GlobalShifter</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">dim</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>                  <span class="Comment">## Shift dimension</span>
  <span class="Identifier">len</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">int</span>                  <span class="Comment">## Displacement (+forward, -backward)</span>
  <span class="Comment">## MPI decomposition grid</span>
  <span class="Comment">## Product of localGeom[]</span>
  <span class="Comment">## Product of shape[]</span></pre></dt>
  <dd>
    
    <p>Distributed-memory field shifter backed by Global Arrays ghost exchange</p>
<p>Unlike the single-rank <tt class="docutils literal"><span class="pre">Shifter[D,T]</span></tt> in transporter.nim, a <tt class="docutils literal"><span class="pre">GlobalShifter</span></tt> performs real MPI communication via <tt class="docutils literal"><span class="pre">GA_Update_ghost_dir</span></tt> so that neighbor lookups near partition boundaries read correct remote data.</p>
<p>Usage:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">lat</span> <span class="Operator">=</span> <span class="Identifier">newSimpleCubicLattice</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">8</span><span class="Punctuation">,</span><span class="DecNumber">8</span><span class="Punctuation">,</span><span class="DecNumber">8</span><span class="Punctuation">,</span><span class="DecNumber">16</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">4</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
<span class="Keyword">var</span> <span class="Identifier">field</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span>
<span class="Keyword">let</span> <span class="Identifier">shifter</span> <span class="Operator">=</span> <span class="Identifier">newGlobalShifter</span><span class="Punctuation">(</span><span class="Identifier">field</span><span class="Punctuation">,</span> <span class="Identifier">dim</span><span class="Operator">=</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="Identifier">len</span><span class="Operator">=</span><span class="DecNumber">1</span><span class="Punctuation">)</span>
<span class="Keyword">var</span> <span class="Identifier">dest</span>   <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span><span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span>
<span class="Identifier">shifter</span><span class="Operator">.</span><span class="Identifier">apply</span><span class="Punctuation">(</span><span class="Identifier">field</span><span class="Punctuation">,</span> <span class="Identifier">dest</span><span class="Punctuation">)</span>   <span class="Comment"># dest[x] = field[x + e_3]</span></pre></p>

    
  </dd>
</div>
<div id="TensorField">
  <dt><pre><a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span> <span class="Other">=</span> <span class="Keyword">object</span>
  <span class="Identifier">lattice</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">L</span>
  <span class="Identifier">shape</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span>
  <span class="Keyword">when</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">1</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">2</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">2</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">2</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">2</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">3</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">3</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">3</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">3</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">4</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">4</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">4</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">4</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">5</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">5</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">5</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">5</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">6</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">6</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">6</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">6</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">7</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">7</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">7</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">7</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">8</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">8</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">8</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">8</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">9</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">9</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">9</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">9</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">10</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">10</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">10</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span>
  <span class="Keyword">elif</span> <span class="Identifier">D</span> <span class="Operator">+</span> <span class="Identifier">R</span> <span class="Operator">==</span> <span class="DecNumber">10</span><span class="Other">:</span>
    <span class="Keyword">when</span> <span class="Identifier">isComplex32</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">11</span><span class="Other">,</span> <span class="Identifier">float32</span><span class="Other">]</span>
    <span class="Keyword">elif</span> <span class="Identifier">isComplex64</span><span class="Other">(</span><span class="Identifier">T</span><span class="Other">)</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">11</span><span class="Other">,</span> <span class="Identifier">float64</span><span class="Other">]</span>
    <span class="Keyword">else</span><span class="Other">:</span>
      <span class="Identifier">data</span><span class="Operator">*</span><span class="Other">:</span> <span class="Identifier">GlobalArray</span><span class="Other">[</span><span class="DecNumber">11</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Distributed tensor field backed by a Global Array.</p>
<p>Represents a rank-<tt class="docutils literal"><span class="pre">R</span></tt> tensor field defined on a <tt class="docutils literal"><span class="pre">D</span></tt>-dimensional lattice, stored as a distributed GA with ghost regions for MPI communication.  The element type <tt class="docutils literal"><span class="pre">T</span></tt> may be a real scalar or a complex type (<tt class="docutils literal"><span class="pre"><span class="Identifier">Complex32</span></span></tt>, <tt class="docutils literal"><span class="pre"><span class="Identifier">Complex64</span></span></tt>).</p>

    
  </dd>
</div>

  </dl>
</div>
<div class="section" id="12">
  <h1><a class="toc-backref" href="#12">Procs</a></h1>
  <dl class="item">
    <div id="accessGhosts-procs-all">
  <div id="accessGhosts,TensorField[D,R,L: Lattice[accessGhosts.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#accessGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BaccessGhosts.D%5D%2CT%5D"><span class="Identifier">accessGhosts</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Access local data including ghost regions</p>
<p>Returns a raw pointer to the padded data (local + ghost regions). Ghost regions must have been updated via <tt class="docutils literal"><span class="pre">updateAllGhosts</span></tt> first. Must call <tt class="docutils literal"><span class="pre">releaseLocal</span></tt> when done.</p>

    
  </dd>
</div>

</div>
<div id="accessLocal-procs-all">
  <div id="accessLocal,TensorField[D,R,L: Lattice[accessLocal.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#accessLocal%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BaccessLocal.D%5D%2CT%5D"><span class="Identifier">accessLocal</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Keyword">ptr</span> <span class="Identifier">UncheckedArray</span><span class="Other">[</span><span class="Identifier">T</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Access local data segment of the tensor field (no ghosts)</p>
<p><strong>Important</strong>: The returned pointer shares the padded memory layout. The stride between consecutive lattice sites is NOT 1 â€” it is determined by the padded inner dimensions (tensor shape + complex, each ghost-padded). Use <tt class="docutils literal"><span class="pre">localIdx</span></tt> to compute the correct flat index for a lattice site.</p>
<p>Must call <tt class="docutils literal"><span class="pre">releaseLocal</span></tt> when done.</p>

    
  </dd>
</div>

</div>
<div id="apply-procs-all">
  <div id="apply,GlobalShifter[D,R,L: Lattice[apply.D],T],TensorField[D,R,L: Lattice[apply.D],T],TensorField[D,R,L: Lattice[apply.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#apply%2CGlobalShifter%5BD%2CR%2CL%3A%20Lattice%5Bapply.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5Bapply.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5Bapply.D%5D%2CT%5D"><span class="Identifier">apply</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">shifter</span><span class="Other">:</span> <a href="globaltensor.html#GlobalShifter"><span class="Identifier">GlobalShifter</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">src</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span>
    <span class="Identifier">dest</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
  <dd>
    
    <p>Apply the shift: <tt class="docutils literal"><span class="pre">dest[x] = src[x + shift]</span></tt></p>
<p>Performs GA ghost exchange in the shift dimension, then reads neighbor values from the ghost-padded local data.</p>

    
  </dd>
</div>

</div>
<div id="applyStencilShift-procs-all">
  <div id="applyStencilShift,TensorField[D,R,L: Lattice[applyStencilShift.D],T],TensorField[D,R,L: Lattice[applyStencilShift.D],T],int,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#applyStencilShift%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BapplyStencilShift.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BapplyStencilShift.D%5D%2CT%5D%2Cint%2Cint"><span class="Identifier">applyStencilShift</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">src</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">dest</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">dim</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span>
    <span class="Identifier">direction</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span></pre></dt>
  <dd>
    
    <p>Apply a single stencil shift using GA ghost exchange</p>
<p>A convenience wrapper: <tt class="docutils literal"><span class="pre">dest[x] = src[x + direction*e_dim]</span></tt></p>
<p>Parameters:</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre">src</span></tt>: Source tensor field</li>
<li><tt class="docutils literal"><span class="pre">dest</span></tt>: Destination tensor field (overwritten)</li>
<li><tt class="docutils literal"><span class="pre">dim</span></tt>: Shift dimension (0..D-1)</li>
<li><tt class="docutils literal"><span class="pre">direction</span></tt>: +1 for forward, -1 for backward</li>
</ul>

    
  </dd>
</div>

</div>
<div id="coordsToLex-procs-all">
  <div id="coordsToLex,array[D,int],array[D,int]">
  <dt><pre><span class="Keyword">proc</span> <a href="#coordsToLex%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D"><span class="Identifier">coordsToLex</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">coords</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">geom</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Convert D-dimensional coordinates to lexicographic index</p>
<p>GA C-order: last dimension is fastest varying.</p>

    
  </dd>
</div>

</div>
<div id="coordsToPaddedFlat-procs-all">
  <div id="coordsToPaddedFlat,array[D,int],array[D,int],array[D,int],int">
  <dt><pre><span class="Keyword">proc</span> <a href="#coordsToPaddedFlat%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D%2Cint"><span class="Identifier">coordsToPaddedFlat</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">coords</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span>
                                       <span class="Identifier">paddedGeom</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span>
                                       <span class="Identifier">ghostWidth</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span>
                                       <span class="Identifier">innerBlockSize</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Convert local lattice coordinates to a flat index in the ghost-padded array</p>
<p>The padded array has D lattice dimensions (each padded by <tt class="docutils literal"><span class="pre">2*ghostWidth</span></tt>) followed by R+1 inner dimensions (also padded). This function computes the index for the center element of the inner block at the given lattice site.</p>
<p>Parameters:</p>
<ul class="simple"><li>coords: Local lattice coordinates (can be negative for backward ghost)</li>
<li>paddedGeom: Padded lattice geometry (<tt class="docutils literal"><span class="pre">localGeom + 2*ghostWidth</span></tt> per dim)</li>
<li>ghostWidth: Ghost width per lattice dimension</li>
<li>innerBlockSize: Product of all padded inner dimensions</li>
</ul>
<p>Returns: Flat index into the padded data array (not including inner offset)</p>

    
  </dd>
</div>

</div>
<div id="discreteLaplacian-procs-all">
  <div id="discreteLaplacian,TensorField[D,R,L: Lattice[discreteLaplacian.D],T],TensorField[D,R,L: Lattice[discreteLaplacian.D],T],TensorField[D,R,L: Lattice[discreteLaplacian.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#discreteLaplacian%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BdiscreteLaplacian.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BdiscreteLaplacian.D%5D%2CT%5D%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BdiscreteLaplacian.D%5D%2CT%5D"><span class="Identifier">discreteLaplacian</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">src</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">dest</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span>
    <span class="Identifier">scratch</span><span class="Other">:</span> <span class="Keyword">var</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
  <dd>
    
    <p>Compute the discrete Laplacian: <tt class="docutils literal"><span class="pre">dest[x] = sum_mu (src[x+mu] + src[x-mu]) - 2*D * src[x]</span></tt></p>
<p>Uses GA ghost exchange for boundary communication. <tt class="docutils literal"><span class="pre">scratch</span></tt> is used as temporary storage.</p>

    
  </dd>
</div>

</div>
<div id="ghostWidth-procs-all">
  <div id="ghostWidth,TensorField[D,R,L: Lattice[ghostWidth.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#ghostWidth%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BghostWidth.D%5D%2CT%5D"><span class="Identifier">ghostWidth</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Get the ghost width in each dimension
    
  </dd>
</div>

</div>
<div id="hasGhosts-procs-all">
  <div id="hasGhosts,TensorField[D,R,L: Lattice[hasGhosts.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#hasGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BhasGhosts.D%5D%2CT%5D"><span class="Identifier">hasGhosts</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">bool</span></pre></dt>
  <dd>
    
    Check if tensor field has ghost regions configured
    
  </dd>
</div>

</div>
<div id="innerBlockSize-procs-all">
  <div id="innerBlockSize,staticint,openArray[int],bool">
  <dt><pre><span class="Keyword">proc</span> <a href="#innerBlockSize%2Cstaticint%2CopenArray%5Bint%5D%2Cbool"><span class="Identifier">innerBlockSize</span></a><span class="Other">(</span><span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">shape</span><span class="Other">:</span> <span class="Identifier">openArray</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">isComplex</span><span class="Other">:</span> <span class="Identifier">bool</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Compute the number of contiguous elements per lattice site</p>
<p>This is the product of all tensor shape entries times the complex factor.</p>

    
  </dd>
</div>

</div>
<div id="innerPaddedBlockSize-procs-all">
  <div id="innerPaddedBlockSize,staticint,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#innerPaddedBlockSize%2Cstaticint%2Cint"><span class="Identifier">innerPaddedBlockSize</span></a><span class="Other">(</span><span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">ghostWidth</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Compute the padded inner block size for ghost-padded arrays</p>
<p>Each inner dimension of size S gets padded to <tt class="docutils literal"><span class="pre">S + 2*ghostWidth</span></tt>. The block size is the product of all padded inner dimensions. For scalar real with S=1, ghost=1: each of R+1 dims is padded to 3, so block = 3^(R+1).</p>

    
  </dd>
</div>

</div>
<div id="innerPaddedOffset-procs-all">
  <div id="innerPaddedOffset,staticint,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#innerPaddedOffset%2Cstaticint%2Cint"><span class="Identifier">innerPaddedOffset</span></a><span class="Other">(</span><span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">ghostWidth</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Compute the flat offset to the center element of the padded inner block</p>
<p>In the ghost-padded inner block, each inner dimension of padded size P has the real data at index <tt class="docutils literal"><span class="pre">ghostWidth</span></tt>.  The offset from the start of the padded block to the center (first real element) is: <tt class="docutils literal"><span class="pre">sum_{i=0..R} ghostWidth * stride_i</span></tt></p>

    
  </dd>
</div>

</div>
<div id="lexToCoords-procs-all">
  <div id="lexToCoords,int,array[D,int]">
  <dt><pre><span class="Keyword">proc</span> <a href="#lexToCoords%2Cint%2Carray%5BD%2Cint%5D"><span class="Identifier">lexToCoords</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">idx</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">geom</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Convert lexicographic index to D-dimensional coordinates</p>
<p>Uses GA C-order convention: last dimension is fastest varying. <tt class="docutils literal"><span class="pre">idx = coords[0] * stride0 + coords[1] * stride1 + ... + coords[D-1]</span></tt></p>

    
  </dd>
</div>

</div>
<div id="localGrid-procs-all">
  <div id="localGrid,TensorField[D,R,L: Lattice[localGrid.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#localGrid%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BlocalGrid.D%5D%2CT%5D"><span class="Identifier">localGrid</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Get local grid dimensions (excluding ghosts)
    
  </dd>
</div>

</div>
<div id="localIdx-procs-all">
  <div id="localIdx,TensorField[D,R,L: Lattice[localIdx.D],T],array[D,int]">
  <dt><pre><span class="Keyword">proc</span> <a href="#localIdx%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BlocalIdx.D%5D%2CT%5D%2Carray%5BD%2Cint%5D"><span class="Identifier">localIdx</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">coords</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Compute the flat index into the local data pointer for a lattice site</p>
<p>The GA inner dimensions (tensor shape + complex) are ghost-padded to satisfy GA's requirement that all dimensions have ghost width â‰¥ 1. <tt class="docutils literal"><span class="pre">NGA_Access</span></tt> returns a pointer to the center of the padded block for the first local lattice site, so <tt class="docutils literal"><span class="pre">p[0]</span></tt> is the first real element.  The stride between consecutive lattice sites is the product of all padded inner dimensions (<tt class="docutils literal"><span class="pre">innerPaddedBlockSize</span></tt>).</p>
<p>The returned index points to the center of the padded inner block for the given lattice site.  Add <tt class="docutils literal"><span class="pre">e</span></tt> to reach element <tt class="docutils literal"><span class="pre">e</span></tt> (but only <tt class="docutils literal"><span class="pre">0..&lt;innerBlockSize</span></tt> are real data; the rest is padding).</p>
<p>Parameters:</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre">tensor</span></tt>: The tensor field (used for shape and padding info)</li>
<li><tt class="docutils literal"><span class="pre">coords</span></tt>: Local lattice coordinates</li>
</ul>
<p>Returns: Flat index into the local data pointer for the first real element at the given lattice site.</p>

    
  </dd>
</div>

</div>
<div id="localLexIdx-procs-all">
  <div id="localLexIdx,TensorField[D,R,L: Lattice[localLexIdx.D],T],int">
  <dt><pre><span class="Keyword">proc</span> <a href="#localLexIdx%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BlocalLexIdx.D%5D%2CT%5D%2Cint"><span class="Identifier">localLexIdx</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">site</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Compute the flat index for a lexicographically-ordered site</p>
<p>Converts a lexicographic site index to the flat index in the local data pointer, accounting for lattice-dimension ghost padding while keeping inner (tensor/complex) dimensions contiguous.</p>

    
  </dd>
</div>

</div>
<div id="localSiteOffset-procs-all">
  <div id="localSiteOffset,array[D,int],array[D,int],int">
  <dt><pre><span class="Keyword">proc</span> <a href="#localSiteOffset%2Carray%5BD%2Cint%5D%2Carray%5BD%2Cint%5D%2Cint"><span class="Identifier">localSiteOffset</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">coords</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span>
                                    <span class="Identifier">paddedGeom</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span>
                                    <span class="Identifier">innerBlockSize</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">int</span></pre></dt>
  <dd>
    
    <p>Convert local lattice coordinates to a flat offset in the local data pointer</p>
<p>The local pointer from NGA_Access points into the padded memory at the start of the local region. The memory layout still uses padded strides for the lattice dimensions (which carry ghost regions). The inner block at each lattice site is contiguous with <tt class="docutils literal"><span class="pre">innerBlockSize</span></tt> elements.</p>
<p>Parameters:</p>
<ul class="simple"><li>coords: Local lattice coordinates</li>
<li>paddedGeom: Padded lattice geometry (<tt class="docutils literal"><span class="pre">localGeom + 2*ghostWidth</span></tt> per dim)</li>
<li>innerBlockSize: Number of contiguous inner elements per lattice site</li>
</ul>
<p>Returns: Flat offset from local pointer p<a class="reference internal" href="#0">0</a> to the start of the inner block for the given site.</p>

    
  </dd>
</div>

</div>
<div id="newGlobalBackwardShifters-procs-all">
  <div id="newGlobalBackwardShifters,TensorField[D,R,L: Lattice[newGlobalBackwardShifters.D],T],int">
  <dt><pre><span class="Keyword">proc</span> <a href="#newGlobalBackwardShifters%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewGlobalBackwardShifters.D%5D%2CT%5D%2Cint"><span class="Identifier">newGlobalBackwardShifters</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">field</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">len</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">=</span> <span class="DecNumber">1</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span>
    <a href="globaltensor.html#GlobalShifter"><span class="Identifier">GlobalShifter</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Create backward shifters for all D dimensions
    
  </dd>
</div>

</div>
<div id="newGlobalShifter-procs-all">
  <div id="newGlobalShifter,TensorField[D,R,L: Lattice[newGlobalShifter.D],T],int,int">
  <dt><pre><span class="Keyword">proc</span> <a href="#newGlobalShifter%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewGlobalShifter.D%5D%2CT%5D%2Cint%2Cint"><span class="Identifier">newGlobalShifter</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">field</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">dim</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">len</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">=</span> <span class="DecNumber">1</span><span class="Other">)</span><span class="Other">:</span> <a href="globaltensor.html#GlobalShifter"><span class="Identifier">GlobalShifter</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span>
    <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Create a global shifter for a tensor field in a given dimension</p>
<p>Parameters:</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre">field</span></tt>: The tensor field (used only for geometry, not mutated)</li>
<li><tt class="docutils literal"><span class="pre">dim</span></tt>: Dimension to shift along (0..D-1)</li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: Displacement (+1 = forward, -1 = backward)</li>
</ul>

    
  </dd>
</div>

</div>
<div id="newGlobalShifters-procs-all">
  <div id="newGlobalShifters,TensorField[D,R,L: Lattice[newGlobalShifters.D],T],int">
  <dt><pre><span class="Keyword">proc</span> <a href="#newGlobalShifters%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewGlobalShifters.D%5D%2CT%5D%2Cint"><span class="Identifier">newGlobalShifters</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">field</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">len</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">=</span> <span class="DecNumber">1</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span>
    <a href="globaltensor.html#GlobalShifter"><span class="Identifier">GlobalShifter</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Create forward shifters for all D dimensions
    
  </dd>
</div>

</div>
<div id="newLatticeStencil-procs-all">
  <div id="newLatticeStencil,TensorField[D,R,L: Lattice[newLatticeStencil.D],T],StencilPattern[D]">
  <dt><pre><span class="Keyword">proc</span> <a href="#newLatticeStencil%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BnewLatticeStencil.D%5D%2CT%5D%2CStencilPattern%5BD%5D"><span class="Identifier">newLatticeStencil</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">pattern</span><span class="Other">:</span> <a href="../lattice/stencil.html#StencilPattern"><span class="Identifier">StencilPattern</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <a href="../lattice/stencil.html#LatticeStencil"><span class="Identifier">LatticeStencil</span></a><span class="Other">[</span>
    <span class="Identifier">D</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Create a unified lattice stencil from a tensor field</p>
<p>Automatically extracts local geometry and ghost width from the tensor. The stencil understands both local and ghost regions.</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">lat</span> <span class="Operator">=</span> <span class="Identifier">newSimpleCubicLattice</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">16</span><span class="Punctuation">,</span> <span class="DecNumber">16</span><span class="Punctuation">,</span> <span class="DecNumber">16</span><span class="Punctuation">,</span> <span class="DecNumber">32</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">4</span><span class="Punctuation">]</span><span class="Punctuation">,</span> <span class="Punctuation">[</span><span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">,</span> <span class="DecNumber">1</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
<span class="Keyword">var</span> <span class="Identifier">field</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="DecNumber">3</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">Complex64</span>

<span class="Keyword">let</span> <span class="Identifier">stencil</span> <span class="Operator">=</span> <span class="Identifier">field</span><span class="Operator">.</span><span class="Identifier">newLatticeStencil</span><span class="Punctuation">(</span><span class="Identifier">nearestNeighborStencil</span><span class="Punctuation">[</span><span class="DecNumber">4</span><span class="Punctuation">]</span><span class="Punctuation">(</span><span class="Punctuation">)</span><span class="Punctuation">)</span>

<span class="Comment"># Use stencil with views in each loop</span>
<span class="Keyword">var</span> <span class="Identifier">local</span> <span class="Operator">=</span> <span class="Identifier">field</span><span class="Operator">.</span><span class="Identifier">newLocalTensorField</span><span class="Punctuation">(</span><span class="Punctuation">)</span>
<span class="Identifier">field</span><span class="Operator">.</span><span class="Identifier">updateAllGhosts</span><span class="Punctuation">(</span><span class="Punctuation">)</span>

<span class="Keyword">block</span><span class="Punctuation">:</span>
  <span class="Keyword">var</span> <span class="Identifier">view</span> <span class="Operator">=</span> <span class="Identifier">local</span><span class="Operator">.</span><span class="Identifier">newTensorFieldView</span><span class="Punctuation">(</span><span class="Identifier">iokRead</span><span class="Punctuation">)</span>
  <span class="Keyword">for</span> <span class="Identifier">site</span> <span class="Keyword">in</span> <span class="FloatNumber">0.</span><span class="Operator">.&lt;</span><span class="Identifier">stencil</span><span class="Operator">.</span><span class="Identifier">nSites</span><span class="Punctuation">:</span>
    <span class="Keyword">for</span> <span class="Identifier">dir</span> <span class="Keyword">in</span> <span class="FloatNumber">0.</span><span class="Operator">.&lt;</span><span class="DecNumber">4</span><span class="Punctuation">:</span>
      <span class="Keyword">let</span> <span class="Identifier">fwd</span> <span class="Operator">=</span> <span class="Identifier">view</span><span class="Punctuation">[</span><span class="Identifier">stencil</span><span class="Operator">.</span><span class="Identifier">fwd</span><span class="Punctuation">(</span><span class="Identifier">site</span><span class="Punctuation">,</span> <span class="Identifier">dir</span><span class="Punctuation">)</span><span class="Punctuation">]</span>
      <span class="Keyword">let</span> <span class="Identifier">bwd</span> <span class="Operator">=</span> <span class="Identifier">view</span><span class="Punctuation">[</span><span class="Identifier">stencil</span><span class="Operator">.</span><span class="Identifier">bwd</span><span class="Punctuation">(</span><span class="Identifier">site</span><span class="Punctuation">,</span> <span class="Identifier">dir</span><span class="Punctuation">)</span><span class="Punctuation">]</span></pre></p>

    
  </dd>
</div>

</div>
<div id="newTensorField-procs-all">
  <div id="newTensorField,L,array[R,int],typedesc">
  <dt><pre><span class="Keyword">proc</span> <a href="#newTensorField%2CL%2Carray%5BR%2Cint%5D%2Ctypedesc"><span class="Identifier">newTensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">]</span><span class="Other">(</span><span class="Identifier">lattice</span><span class="Other">:</span> <span class="Identifier">L</span><span class="Other">;</span>
    <span class="Identifier">shape</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">:</span> <span class="Identifier">typedesc</span><span class="Other">)</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span></pre></dt>
  <dd>
    
    <p>Create a new TensorField</p>
<p>Parameters:</p>
<ul class="simple"><li><tt class="docutils literal"><span class="pre"><span class="Identifier">lattice</span></span></tt>: The lattice on which the tensor field is defined</li>
<li><tt class="docutils literal"><span class="pre"><span class="Identifier">shape</span></span></tt>: The shape of the tensor field</li>
</ul>
<p>Returns: A new TensorField instance</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">let</span> <span class="Identifier">lattice</span> <span class="Operator">=</span> <span class="Identifier">newSimpleCubicLattice</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">16</span><span class="Punctuation">,</span> <span class="DecNumber">16</span><span class="Punctuation">,</span> <span class="DecNumber">16</span><span class="Punctuation">,</span> <span class="DecNumber">16</span><span class="Punctuation">]</span><span class="Punctuation">)</span>
<span class="Keyword">let</span> <span class="Identifier">TensorField</span> <span class="Operator">=</span> <span class="Identifier">lattice</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="DecNumber">3</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">float64</span></pre></p>

    
  </dd>
</div>

</div>
<div id="paddedGrid-procs-all">
  <div id="paddedGrid,TensorField[D,R,L: Lattice[paddedGrid.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#paddedGrid%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BpaddedGrid.D%5D%2CT%5D"><span class="Identifier">paddedGrid</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span><span class="Other">:</span> <span class="Identifier">array</span><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">int</span><span class="Other">]</span></pre></dt>
  <dd>
    
    Get padded grid dimensions (including ghosts on both sides)
    
  </dd>
</div>

</div>
<div id="releaseLocal-procs-all">
  <div id="releaseLocal,TensorField[D,R,L: Lattice[releaseLocal.D],T]">
  <dt><pre><span class="Keyword">proc</span> <a href="#releaseLocal%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BreleaseLocal.D%5D%2CT%5D"><span class="Identifier">releaseLocal</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">)</span></pre></dt>
  <dd>
    
    Release local data access obtained via <tt class="docutils literal"><span class="pre">accessLocal</span></tt> or <tt class="docutils literal"><span class="pre">accessGhosts</span></tt>
    
  </dd>
</div>

</div>
<div id="updateAllGhosts-procs-all">
  <div id="updateAllGhosts,TensorField[D,R,L: Lattice[updateAllGhosts.D],T],bool">
  <dt><pre><span class="Keyword">proc</span> <a href="#updateAllGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BupdateAllGhosts.D%5D%2CT%5D%2Cbool"><span class="Identifier">updateAllGhosts</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">updateCorners</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">=</span> <span class="Identifier">false</span><span class="Other">)</span></pre></dt>
  <dd>
    
    <p>Update ghost regions in all lattice dimensions</p>
<p>Skips dimensions with ghost width 0 (including inner tensor/complex dimensions).  Uses <tt class="docutils literal"><span class="pre">GA_Update_ghost_dir</span></tt> for each lattice dimension.</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">var</span> <span class="Identifier">field</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="DecNumber">3</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">Complex64</span>
<span class="Comment"># ... modify local data ...</span>
<span class="Identifier">field</span><span class="Operator">.</span><span class="Identifier">updateAllGhosts</span><span class="Punctuation">(</span><span class="Punctuation">)</span>  <span class="Comment"># Update all ghost regions</span></pre></p>

    
  </dd>
</div>

</div>
<div id="updateGhosts-procs-all">
  <div id="updateGhosts,TensorField[D,R,L: Lattice[updateGhosts.D],T],int,int,bool">
  <dt><pre><span class="Keyword">proc</span> <a href="#updateGhosts%2CTensorField%5BD%2CR%2CL%3A%20Lattice%5BupdateGhosts.D%5D%2CT%5D%2Cint%2Cint%2Cbool"><span class="Identifier">updateGhosts</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">R</span><span class="Other">:</span> <span class="Identifier">static</span><span class="Other">[</span><span class="Identifier">int</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">L</span><span class="Other">:</span> <a href="../lattice/latticeconcept.html#Lattice"><span class="Identifier">Lattice</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">(</span>
    <span class="Identifier">tensor</span><span class="Other">:</span> <a href="globaltensor.html#TensorField"><span class="Identifier">TensorField</span></a><span class="Other">[</span><span class="Identifier">D</span><span class="Other">,</span> <span class="Identifier">R</span><span class="Other">,</span> <span class="Identifier">L</span><span class="Other">,</span> <span class="Identifier">T</span><span class="Other">]</span><span class="Other">;</span> <span class="Identifier">dim</span><span class="Other">:</span> <span class="Identifier">int</span><span class="Other">;</span> <span class="Identifier">direction</span><span class="Other">:</span> <span class="Identifier">int</span> <span class="Other">=</span> <span class="DecNumber">0</span><span class="Other">;</span>
    <span class="Identifier">updateCorners</span><span class="Other">:</span> <span class="Identifier">bool</span> <span class="Other">=</span> <span class="Identifier">false</span><span class="Other">)</span></pre></dt>
  <dd>
    
    <p>Update ghost regions for a tensor field in specified dimension</p>
<p>This synchronizes ghost (halo) regions between MPI ranks. Must be called before reading from ghost regions after local updates.</p>
<p>Parameters: tensor: The tensor field to update dim: Dimension to update (0..D-1) direction: +1 for forward, -1 for backward, 0 for both (default) updateCorners: Whether to update corner ghost cells</p>
<p>Example:</p>
<p><pre class="listing"><span class="Keyword">var</span> <span class="Identifier">field</span> <span class="Operator">=</span> <span class="Identifier">lat</span><span class="Operator">.</span><span class="Identifier">newTensorField</span><span class="Punctuation">(</span><span class="Punctuation">[</span><span class="DecNumber">3</span><span class="Punctuation">,</span> <span class="DecNumber">3</span><span class="Punctuation">]</span><span class="Punctuation">)</span><span class="Punctuation">:</span> <span class="Identifier">Complex64</span>
<span class="Comment"># ... modify local data ...</span>
<span class="Identifier">field</span><span class="Operator">.</span><span class="Identifier">updateGhosts</span><span class="Punctuation">(</span><span class="DecNumber">0</span><span class="Punctuation">)</span>  <span class="Comment"># Update ghosts in x direction</span>
<span class="Identifier">field</span><span class="Operator">.</span><span class="Identifier">updateGhosts</span><span class="Punctuation">(</span><span class="DecNumber">1</span><span class="Punctuation">)</span>  <span class="Comment"># Update ghosts in y direction</span>
<span class="Comment"># Now ghost regions contain correct neighbor data</span></pre></p>

    
  </dd>
</div>

</div>

  </dl>
</div>

  </div>
</div>

      <div class="twelve-columns footer">
        <span class="nim-sprite"></span>
        <br>
        <small style="color: var(--hint);">Made with Nim. Generated: 2026-02-07 07:38:44 UTC</small>
      </div>
    </div>
  </div>
  
</body>
</html>
